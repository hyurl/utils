{"version":3,"file":"timestamp.js","sources":["../timestamp.ts"],"sourcesContent":["import { isValid } from \"@ayonli/jsext/object\";\nimport { isNumeric } from \"@ayonli/jsext/number\";\nexport default timestamp;\nfunction timestamp(input, ms = false) {\n    var _a;\n    if (typeof input === \"boolean\") {\n        ms = input;\n        input = void 0;\n    }\n    input = input || new Date();\n    if (input instanceof Date) {\n        return ms ? input.valueOf() : Math.floor(input.valueOf() / 1000);\n    }\n    else if (typeof input === \"number\") {\n        return ms ? input : Math.floor(input / 1000);\n    }\n    else {\n        let date;\n        let dateTime = String(input).trim();\n        if (dateTime.includes(\",\") && dateTime.split(\",\").every(isNumeric)) {\n            date = parseDateRawArgs(dateTime);\n        }\n        else {\n            let match = null;\n            if (match = dateTime.match(/^(\\d{1,2}):\\d{2}(:\\d{2})?/)) { // time only\n                if (((_a = match[1]) === null || _a === void 0 ? void 0 : _a.length) !== 2) {\n                    dateTime = \"0\" + dateTime;\n                }\n                if (!match[2]) {\n                    dateTime += \":00\";\n                }\n                date = new Date();\n                dateTime = date.getFullYear()\n                    + \"-\" + String(date.getMonth() + 1).padStart(2, \"0\")\n                    + \"-\" + String(date.getDate()).padStart(2, \"0\")\n                    + \" \" + dateTime;\n            }\n            date = new Date(dateTime);\n        }\n        if (String(date) !== \"Invalid Date\") {\n            return ms ? date.valueOf() : Math.floor(date.valueOf() / 1000);\n        }\n        else {\n            console.log(dateTime);\n            throw new Error(\"The input argument is not a valid date-time string\");\n        }\n    }\n}\nfunction parseDateRawArgs(str) {\n    let [Y, M, D, H, m, s, ms] = str.split(\",\").map(Number);\n    let date = new Date();\n    isValid(Y) && date.setFullYear(Y);\n    isValid(M) && date.setMonth(M);\n    isValid(D) && date.setDate(D);\n    isValid(H) && date.setHours(H);\n    isValid(m) && date.setMinutes(m);\n    isValid(s) && date.setSeconds(s);\n    isValid(ms) && date.setMilliseconds(ms);\n    return date;\n}\n//# sourceMappingURL=timestamp.js.map"],"names":[],"mappings":"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"}