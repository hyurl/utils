{"version":3,"file":"omitVoid.js","sources":["../omitVoid.ts"],"sourcesContent":["import isEmpty from \"./isEmpty\";\nimport { isArrayLike, isBufferLike } from 'is-like';\nimport { isValid } from \"@ayonli/jsext/object\";\n/**\n * Creates an object composed with only the non-void properties.\n * @param omitEmptyObjects If set, empty properties of type `object` will be\n *  removed as well.\n * @param omitEmptyStrings If set, empty properties of type `string` will be\n *  removed as well.\n */\nexport default function omitVoid(target, deep = false, omitEmptyObjects = false, omitEmptyStrings = false) {\n    return doOmit(target, deep, omitEmptyObjects, omitEmptyStrings, 0);\n}\nexport function doOmit(target, deep, omitEmptyObjects, omitEmptyStrings, depth) {\n    if (typeof target === \"string\") {\n        return omitEmptyStrings && target.trim() === \"\"\n            ? (depth > 0 ? void 0 : \"\")\n            : target;\n    }\n    else if (target === null\n        || typeof target !== \"object\"\n        || target instanceof Date\n        || target instanceof Error\n        || target instanceof RegExp\n        || isBufferLike(target)) {\n        return target;\n    }\n    else if (omitEmptyObjects && isEmpty(target)) {\n        return depth > 0 ? void 0 : (isArrayLike(target, true) ? [] : {});\n    }\n    if (isArrayLike(target, true)) {\n        let arr = [];\n        for (let i = 0, len = target.length; i < len; ++i) {\n            let value = target[i];\n            if (isValid(value)) {\n                if (deep) {\n                    value = doOmit(value, deep, omitEmptyObjects, omitEmptyStrings, depth + 1);\n                    !isValid(value) || arr.push(value);\n                }\n                else {\n                    arr.push(value);\n                }\n            }\n        }\n        if (depth > 0 && omitEmptyObjects && isEmpty(arr)) {\n            return void 0;\n        }\n        else {\n            return arr;\n        }\n    }\n    else {\n        let obj = Reflect.ownKeys(target).reduce((obj, key) => {\n            let value = target[key];\n            if (isValid(value)) {\n                if (deep) {\n                    value = doOmit(value, deep, omitEmptyObjects, omitEmptyStrings, depth + 1);\n                    !isValid(value) || (obj[key] = value);\n                }\n                else {\n                    obj[key] = value;\n                }\n            }\n            return obj;\n        }, {});\n        if (depth > 0 && omitEmptyObjects && isEmpty(obj)) {\n            return void 0;\n        }\n        else {\n            return obj;\n        }\n    }\n}\n//# sourceMappingURL=omitVoid.js.map"],"names":["isBufferLike","isArrayLike"],"mappings":"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"}